---
- name: STOPing Docker containers
  hosts: "{{ plat }}"
  become: true
  tasks:

  - name: check if the DOCKER svc exists
    stat: path=/etc/init.d/docker
    register: svc_status

  - shell: "/usr/bin/docker stop $(docker ps -q)"
    when: svc_status.stat.exists    

  - shell: "/usr/bin/docker rm -v $(docker ps -q -f status=exited)"
    when: svc_status.stat.exists

  # DEBIAN/UBUNTU

#  - name: remove Docker package
#    apt: name={{ item }} state=absent
#    with_items:
#      - docker
#      - docker-engine
#    when: ansible_os_family == "Debian"


  # REDHAT/CENTOS

#  - name: remove Docker package
#    apt: name={{ item }} state=absent
#    with_items:
#      - docker-engine-selinux
#      - docker-engine
#    when: ansible_os_family == "RedHat"

#  - name: remove Docker cache
#    command: rm -rf /var/lib/docker

