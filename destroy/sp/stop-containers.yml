---
- name: STOPing Docker containers
  hosts: "{{ environ }}"
  become: true
  tasks:

  - name: check if the DOCKER svc exists
    stat: path=/etc/init.d/docker
    register: svc_status

  - shell: "/usr/bin/docker stop $(docker ps -q)"
    when: svc_status.stat.exists    

  - shell: "/usr/bin/docker rm -v $(docker ps -q -f status=exited)"
    when: svc_status.stat.exists
