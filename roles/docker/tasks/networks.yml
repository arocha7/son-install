- name: Docker User Defined Network
  shell: 'if ! [[ "$(sudo docker network inspect {{ docker_network_name }} 2> /dev/null)" == "" ]]; then sudo docker network rm {{ docker_network_name }}; fi && sudo service docker restart'
  become: true
  ignore_errors: true
  no_log: true
  register: dockernet

- debug:
    var: dockernet

- name: Docker creating network
  shell: 'sudo docker network create --driver=bridge --subnet=172.20.1.0/24 --gateway=172.20.1.1 --ip-range=172.20.1.128/25 "{{ docker_network_name }}"'
  notify:
    - restart docker
  become: true
  when: dockernet|succeeded

