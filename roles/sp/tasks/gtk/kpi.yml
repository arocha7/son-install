---

  - name: GATEKEEPER KEY PERFORMANCE INDICATORS (GTKKPI) (Docker container)
    docker_container:
      name: son-gtkkpi
      image: "sonatanfv/son-gtkkpi:{{ ver }}"
      state: started
      restart_policy: "unless-stopped"
      env:
        PUSHGATEWAY_HOST: "{{ public_ip }}
        PUSHGATEWAY_PORT: 9091
        PROMETHEUS_PORT: 9090
        RACK_ENV: integration
      network_mode: bridge
      networks:
        - name: "{{ docker_network_name }}"
          aliases:
            - son-gtkkpi
      published_ports: "5400:5400"

  - wait_for: host=0.0.0.0 port=5400 timeout=120 delay=10 state=started

